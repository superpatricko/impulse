PROCEDURE "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::SP_QUERY_ANALYSER" ( IN IP_LOB_CODE INTEGER,
     IN IP_BAN NVARCHAR(20),
	 IN IP_SUBCR_NO NVARCHAR(20),
	 IN IP_GROUP NVARCHAR(100)
	 ) 
	 
	LANGUAGE SQLSCRIPT
	SQL SECURITY INVOKER 
	--DEFAULT SCHEMA <default_schema_name>
	--READS SQL DATA 
	AS
BEGIN

----------------------------------------------------------------------------------------------------
-- Procedure Title : IFRS_R1.COMMON_COMP.RAI_COMMON::SP_QUERY_ANALYSER
----------------------------------------------------------------------------------------------------
-- Created By      : BC_EY94105(Snehlata)          Date :10/09/2016
----------------------------------------------------------------------------------------------------
-- Procedure Description : 
-- ERROR_LOG Table :

-- Track Error/Process Control Table:
----------------------------------------------------------------------------------------------------
-- Release :R1/IFRS
----------------------------------------------------------------------------------------------------
--   M O D I F I C A T I O N   H I S T O R Y
----------------------------------------------------------------------------------------------------
-- Date        | User ID          | Modification History/Release
----------------------------------------------------------------------------------------------------
--   
----------------------------------------------------------------------------------------------------
-- Description Of the changes 
----------------------------------------------------------------------------------------------------
-- Modification Number          :
-- Description of Changes Made> :      
----------------------------------------------------------------------------------------------------
-- Local Variables

DECLARE QUERY_COUNT INT:=0;
	 DECLARE i, j INT:=0;
 	 DECLARE QUERY_STATEMENT NVARCHAR(4000):='';
	 DECLARE QUERY_STATEMENT_BAN NVARCHAR(4000):='';
	 DECLARE QUERY_STATEMENT_SUBCR_NO NVARCHAR(4000):='';
	 DECLARE QUERY_STATEMENT_MAIN NVARCHAR(4000):='';
	 DECLARE QUERY_STATEMENT_FINAL NVARCHAR(8388607) DEFAULT '';
	 DECLARE V_BAN NVARCHAR(20):='';
	 DECLARE V_SUBCR_NO NVARCHAR(20) DEFAULT '%';
	 DECLARE V_LOB_CODE INTEGER;
	 DECLARE V_GROUP NVARCHAR(100) DEFAULT '%';
	 DECLARE QUERY_TABLE_NAME NVARCHAR(500);
	 DECLARE V_POSITION INT:=0;
	 DECLARE V_COLUMN_NAME NVARCHAR (200);
	 DECLARE V_LAYER NVARCHAR (50);
	 DECLARE COLUMN_COUNT INT:=0;
	 DECLARE COLUMN_LIST NVARCHAR(8388607);
	 DECLARE V_CS_DATA_TYPE_NAME NVARCHAR(8388607);
	 DECLARE COLUMN_LIST_DISPLAY NVARCHAR(8388607);
	 DECLARE CURSOR CURR_ID FOR SELECT ID, STATEMENT AS QUERY_STATEMENT, TABLE_NAME AS QUERY_TABLE_NAME, LAYER AS V_LAYER 
			FROM "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" 
			WHERE LOB_CODE in (IP_LOB_CODE) AND GRP LIKE IP_GROUP;
	 V_BAN:= IP_BAN;
	 V_SUBCR_NO:= IP_SUBCR_NO;
	 V_LOB_CODE:= IP_LOB_CODE;
	 V_GROUP:= IP_GROUP;

DELETE FROM "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY";

INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (1,'"LAND"."IFRS_R1.LAND::NM1_EDW_AG"', 'LANDING ORDER',1,'1','SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_AG" WHERE 1=1 AND BAN=''v_ban'' AND SUBCR_NO LIKE ''v_subcr_no''; ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (2,'"LAND"."IFRS_R1.LAND::NM1_EDW_CONTR"', 'LANDING ORDER',1,'1','SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_CONTR" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCRIBER_NO LIKE ''v_subcr_no'';     ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (3,'"LAND"."IFRS_R1.LAND::NM1_EDW_EQP"', 'LANDING ORDER',1,'1','SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_EQP" WHERE 1=1 AND SIM=''-1'' AND BAN=''v_ban'' AND SUBCR_NO LIKE ''v_subcr_no'' ;  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (4,'"LAND"."IFRS_R1.LAND::NM1_EDW_BAN"', 'LANDING CUSTOMER',1,'1','SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_BAN" WHERE 1=1 AND BAN=''v_ban''; ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (5,'"LAND"."IFRS_R1.LAND::NM1_EDW_SUB"', 'LANDING CUSTOMER',1,'1', 'SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_SUB" WHERE 1=1 AND CUST_ID=''v_ban'' AND SUBS_NO LIKE ''v_subcr_no'';       ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (6,'"LAND"."IFRS_R1.LAND::NM1_BILL"', 'LANDING BILLING',1,'1','SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_BILL" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCRIBER_NO LIKE ''v_subcr_no'';');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (7,'"LAND"."IFRS_R1.LAND::NM1_EDW_REF_SOC_HIST"', 'LANDING REFERENCE',1,'1', 'SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_REF_SOC_HIST" WHERE 1=1 AND SOC IN(SELECT SOC FROM "LAND"."IFRS_R1.LAND::NM1_EDW_AG" WHERE BAN=''v_ban'' AND SUBCR_NO LIKE ''v_subcr_no'');    ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (8,'"LAND"."IFRS_R1.LAND::NM1_EDW_REF_FEAT_HIST"', 'LANDING REFERENCE',1,'1', 'SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_REF_FEAT_HIST" WHERE 1=1 AND FEAT_CD IN (SELECT FEAT_CD FROM  "LAND"."IFRS_R1.LAND::NM1_EDW_AG" WHERE BAN=''v_ban'' AND SUBCR_NO LIKE ''v_subcr_no'');  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (9,'"LAND"."IFRS_R1.LAND::NM1_EDW_REF_ECON_INDC_HIST"', 'LANDING REFERENCE',1,'1', 'SELECT * FROM "LAND"."IFRS_R1.LAND::NM1_EDW_REF_ECON_INDC_HIST" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCRIBER_NO LIKE ''v_subcr_no''; ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (10,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER"', 'NDB', 1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (11,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_CUST"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_CUST" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';     ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (12,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_BILL"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_BILL" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';     ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (13,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_SOC_HIST"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_SOC_HIST" WHERE 1=1 AND SOC IN (SELECT ITEM_ID FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER" WHERE BAN=''v_ban''AND SUBSCR_NO LIKE ''v_subcr_no'' ); ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (14,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_FEATURE_HIST"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_FEATURE_HIST" WHERE 1=1 AND FEAT_CD IN(SELECT ITEM_SUB_ID FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER" WHERE BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'');    ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (15,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ECON_INDUCE"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ECON_INDUCE" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (16,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER_EH"', 'NDB', 1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER_EH" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (17,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_CUST_EH"', 'NDB', 1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_CUST_EH" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';     ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (18,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_BILL_EH"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_BILL_EH" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (19,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_SOC_HIST_EH"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_SOC_HIST_EH" WHERE 1=1 AND SOC IN (SELECT ITEM_ID FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER" WHERE BAN=''v_ban''AND SUBSCR_NO LIKE ''v_subcr_no''); ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (20,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_FEATURE_HIST_EH"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_FEATURE_HIST_EH" WHERE 1=1 AND FEAT_CD IN(SELECT ITEM_SUB_ID FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER" WHERE BAN=''v_ban''AND SUBSCR_NO LIKE ''v_subcr_no'');     ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (21,'"NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ECON_INDUCE_EH"', 'NDB',1,'2','SELECT * FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ECON_INDUCE_EH" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no'';     ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (22,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN"', 'RAI',1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN" WHERE 1=1 AND HEADER_ID=''v_ban'' AND SRCDOC_ID LIKE ''v_subcr_no%'';       ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (23,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN"', 'RAI',1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN" WHERE 1=1 AND HEADER_ID=''v_ban'' AND REFERENCE_ID LIKE ''%v_subcr_no%'';   ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (24,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_COND"', 'RAI',1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_COND" WHERE 1=1 AND SRCDOC_ID IN(SELECT SRCDOC_ID FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN" WHERE HEADER_ID=''v_ban''AND REFERENCE_ID LIKE ''%v_subcr_no%'');    ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (25,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN_EH"', 'RAI',1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN_EH" WHERE 1=1 AND HEADER_ID=''v_ban'' AND REFERENCE_ID LIKE ''%v_subcr_no%'';  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (26,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_COND_EH"', 'RAI', 1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_COND_EH" WHERE 1=1 AND SRCDOC_ID IN(SELECT SRCDOC_ID FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN_EH" WHERE HEADER_ID=''v_ban'' AND REFERENCE_ID LIKE ''%v_subcr_no%'');  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (27,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_MAIN"', 'RAI', 1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_MAIN" WHERE 1=1 AND HEADER_ID=''v_ban'' AND ORIGDOC_ID IN(SELECT SRCDOC_ID FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_ORDR_MAIN" WHERE HEADER_ID=''v_ban'' AND SRCDOC_ID LIKE ''v_subcr_no%'');  ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (28,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_MAIN_EH"', 'RAI',1,'3', 'SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_MAIN_EH" WHERE 1=1 AND HEADER_ID=''v_ban'';');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (29,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_COND_EH"', 'RAI',1,'3', 'SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_COND_EH" WHERE 1=1 AND SRCDOC_ID IN(SELECT SRCDOC_ID FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_MAIN_EH" WHERE HEADER_ID=''v_ban'');');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (30,'"RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_COND"', 'RAI', 1,'3','SELECT * FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_COND" WHERE 1=1 AND SRCDOC_ID IN(SELECT SRCDOC_ID FROM "RAI_MOBILITY"."IFRS_R1.MOBILITY.RAI_MOBILITY::MOBL_INVC_MAIN" WHERE HEADER_ID=''v_ban''); ');
INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" VALUES (31,'"SDA"."ZDEF_POSTING"','SDA',1,'4', 'SELECT * FROM  "SDA"."ZDEF_POSTING" WHERE PROVINCE IN(SELECT SAP FROM "SDA"."ZFENSPA_LINEITEM" WHERE(SUBFIELD = ''PRVC'') AND AMDOCS IN( SELECT PROV_CUST FROM "NDB_MOBILITY"."IFRS_R1.MOBILITY.NDB_MOBILITY::MOBL_POST_ORDER" WHERE 1=1 AND BAN=''v_ban'' AND SUBSCR_NO LIKE ''v_subcr_no''));');


	SELECT COUNT(*) into QUERY_COUNT FROM "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY" WHERE LOB_CODE in (V_LOB_CODE) AND GRP IN (V_GROUP);

 	FOR i AS CURR_ID DO 
 		SELECT COUNT(COLUMN_NAME) 
			INTO COLUMN_COUNT 
		FROM SYS.TABLE_COLUMNS 
		WHERE '"'||SCHEMA_NAME||'"."'||TABLE_NAME||'"' = i.QUERY_TABLE_NAME;

	 	FOR j IN 1..COLUMN_COUNT DO 
	 		SELECT
				 COLUMN_NAME,
				 POSITION ,
				 CS_DATA_TYPE_NAME 
			INTO V_COLUMN_NAME,
				 V_POSITION ,
				 V_CS_DATA_TYPE_NAME 
			FROM SYS.TABLE_COLUMNS 
			WHERE '"'||SCHEMA_NAME||'"."'||TABLE_NAME||'"' = i.QUERY_TABLE_NAME AND POSITION = :j;
	 
			IF :V_POSITION = 1 THEN COLUMN_LIST_DISPLAY := :V_COLUMN_NAME;
			 ELSE COLUMN_LIST_DISPLAY:= :COLUMN_LIST_DISPLAY ||'#'|| :V_COLUMN_NAME;
			END IF;
			 
			IF (V_CS_DATA_TYPE_NAME = 'INT' 
					OR V_CS_DATA_TYPE_NAME = 'DECIMAL_FLOAT' 
					OR V_CS_DATA_TYPE_NAME = 'FLOAT' 
					OR V_CS_DATA_TYPE_NAME = 'DOUBLE' 
					OR V_CS_DATA_TYPE_NAME = 'FIXED') 
				THEN V_COLUMN_NAME := 'IFNULL('|| V_COLUMN_NAME||',0)';
				ELSE V_COLUMN_NAME := 'IFNULL('||V_COLUMN_NAME||','''')';
			END IF;
			 
			IF :V_POSITION = 1 
				THEN COLUMN_LIST := :V_COLUMN_NAME;
				ELSE COLUMN_LIST:= :COLUMN_LIST ||'||''#''||'|| :V_COLUMN_NAME;
			END IF;
	 
		END FOR;
 
		COLUMN_LIST_DISPLAY:= 'SELECT ''' || i.V_LAYER ||'#'|| i.QUERY_TABLE_NAME ||'#' || :COLUMN_LIST_DISPLAY || ''' FROM DUMMY ';

		SELECT REPLACE(i.QUERY_STATEMENT, 'v_ban', :V_BAN) INTO QUERY_STATEMENT_BAN FROM DUMMY;
		SELECT REPLACE(:QUERY_STATEMENT_BAN, 'v_subcr_no', :V_SUBCR_NO) INTO QUERY_STATEMENT_MAIN FROM DUMMY;
		SELECT REPLACE(:QUERY_STATEMENT_MAIN, ';', '') INTO QUERY_STATEMENT_MAIN FROM DUMMY;
		SELECT REPLACE(:QUERY_STATEMENT_MAIN, '*', ''''||i.V_LAYER ||'#''||'||''''||i.QUERY_TABLE_NAME ||'#''||'||:COLUMN_LIST) INTO QUERY_STATEMENT_MAIN FROM DUMMY;
	 
		IF (QUERY_STATEMENT_FINAL ='' ) THEN QUERY_STATEMENT_FINAL := :COLUMN_LIST_DISPLAY || ' UNION ' || :QUERY_STATEMENT_MAIN;
		 ELSE QUERY_STATEMENT_FINAL:= :QUERY_STATEMENT_FINAL || ' UNION '|| :COLUMN_LIST_DISPLAY || ' UNION ' || :QUERY_STATEMENT_MAIN;
		END IF;
	END FOR;
	
	SELECT :QUERY_STATEMENT_FINAL FROM DUMMY;
	DELETE FROM "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY_RESULT";
	QUERY_STATEMENT_FINAL:= 'INSERT INTO "RAI_COMMON"."IFRS_R1.COMMON_COMP.RAI_COMMON::IFRS_QUERY_RESULT" '|| :QUERY_STATEMENT_FINAL ;
	EXECUTE IMMEDIATE :QUERY_STATEMENT_FINAL;

END;